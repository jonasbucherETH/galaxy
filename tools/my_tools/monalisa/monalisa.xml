<tool id="monaLisa" name="monaLisa motif enrichment analysis" version="0.1.0+galaxy0" profile="21.05">
    <requirements>
        <requirement type="package" version="4.3.0">r-base</requirement>
        <requirement type="package" version="1.20.3">r-getopt</requirement>
        <requirement type="package" version="1.38.0">bioconductor-bsseq</requirement>
        <requirement type="package" version="1.22.0">bioconductor-dmrseq</requirement>
        <requirement type="package" version="1.15.4">r-data.table</requirement>
        <requirement type="package" version="1.62.0">bioconductor-rtracklayer</requirement>
        <requirement type="package" version="2.70.1">bioconductor-biostrings</requirement>
        <requirement type="package" version="1.12.0">bioconductor-biocio</requirement>
        <requirement type="package" version="1.7.5">r-optparse</requirement>
    </requirements>
    <required_files>
        <include path="monalisa.R" />
    </required_files>

    <stdio>
        <exit_code range="1:" />
    </stdio>

    <command detect_errors="exit_code"><![CDATA[

        Rscript '$__tool_directory__/monalisa.R'
        --input_regions '$input_regions'
        --input_hypo '$input_hypo'
        --input_hyper '$input_hyper'
        --output_hypo '$output_hypo'
        --output_hyper '$output_hyper'
        --cytosine_context '$cytosine_context'
        --reference_genome '$reference_genome'
        --tax_group '$tax_group'
        --sample_info_file '$sample_info_file'
        
    ]]></command>
    <inputs>
        <param name="cytosine_context" type="select" value="CG" label="Cytosine context" help="Cytosine methylation context to analyse" >
            <option value="CG">C(p)G</option>
            <option value="CHG">CHG</option>
            <option value="CHH">CHH</option>
        </param>
        <param type="data" name="input_regions" label="Candidate Regions" format="tabular" />
        <param type="data" name="input_hypo" label="Significant Regions - hypo-methylated" format="tabular" />
        <param type="data" name="input_hyper" label="Significant Regions - hyper-methylated" format="tabular" />        <param type="data" name="reference_genome" format="fasta" label="Select reference genome" help="Choose the reference genome file from your history for the analysis." />
        <param name="sample_info_file" type="data" format="tabular" label="Sample information file" help="CSV file with sample characteristics"/>
        <param name="tax_group" type="select" value="plants" label="Taxonomy group" help="Select the taxonomy group.">
            <option value="plants">plants</option>
            <option value="vertebrates">vertebrates</option>
        </param>
    </inputs>
    <outputs>
        <data name="output_hypo" format="rds" label="Output hypo-methyla: ${cytosine_context} context" />
        <data name="output_hyper" format="rds" label="Output hyper: ${cytosine_context} context" />
    </outputs>
    <tests>
        <test>
            <param name="cytosine_context" value="CHG" />
            <param name="input_regions" value="candidate_regions.tabular" />
            <param name="input_hypo" value="significant_hypo_regions.tabular" />
            <param name="input_hyper" value="significant_hyper_regions.tabular" />
            <param name="reference_genome" value="reference_genome.fasta" />
            <param name="sample_info_file" value="sample_info.tabular" />
            <param name="tax_group" value="vertebrates" />
            <output name="output_hypo" file="expected_hypo_output.rds" />
            <output name="output_hyper" file="expected_hyper_output.rds" />
        </test>
    </tests>
    <help><![CDATA[
    monaLisa help
    ]]></help>
    <citations>
        <citation type="doi">
            10.1093/bioinformatics/btac102
        </citation>
    </citations>
</tool>